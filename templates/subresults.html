<!DOCTYPE html>
{% load static %}
<head>
    <title>OwlJudge</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {% block extrahead %}
      <link href="{% static 'app.css' %}" rel="stylesheet">
    {% endblock %}
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">

<!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
</head>
 <header>
    <nav class="navbar navbar-dark bg-primary">
      <!-- Navbar content -->
      <a href="/owlapp" class="navbar-brand" style="color: white;">OwlJudge</a>
    </nav>
  </header>

<div class="area">
  <p style="margin: 20px;font-size: 30px;">Submission #1</p>
  <br>
  <p style="margin: 20px;font-size: 30px;">Problem Name:</p>
  <p style="margin: 20px;font-size: 30px;">Problem Number:{{problemnumber}}</p>
  <p id="finalstatus" style="margin: 20px;font-size: 30px;">Status:{{status}}</p>
  <p style="margin: 20px;font-size: 30px;">Error Messaage:{{message}}</p>
  {% if status == 'WJ...' %}
    <p style="margin: 20px;font-size: 30px;">Test Case: </p>
    {% for _ in range %}
      <div style="display: flex; font-size: 30px;">
        <p style="margin-left: 50px;">case{{ forloop.counter }}.txt</p>
        <p class='caseclass' id='casestatus{{forloop.counter}}' style="margin-left: 50px;">WJ...</p>
        <p id='timeusage{{forloop.counter}}' style="margin-left: 200px;">WJ...</p>
      </div>
    {% endfor %}
  {% endif %}
</div>


  <script>
      $(document).ready(function() {
      var max = $('.caseclass').length;
      var itemsProcessed = 0;
      $.each(new Array($('.caseclass').length),
       function(n){
        $.ajax({
                        'type': 'get',
                        'url': '/owlapp/judgecode',
                        'data': {
                            'casenumber': n,
                            'submissionid':1,
                            'problemid':1
                        },
                        'success': function(data){
                          const obj = JSON.parse(data);
                          $('#casestatus'+(n+1)).text(obj.result);
                          $('#timeusage'+(n+1)).text(obj.timeusage+'ms');
                          if(obj.result=='AC'){
                            $('#casestatus'+(n+1)).css('color','green');
                          }else{
                            $('#casestatus'+(n+1)).css('color','red');
                            if($('#finalstatus').text()=='Status:WJ...'&&obj.result=='TLE'){
                              $('#finalstatus').text('Status:TLE');
                              $('#finalstatus').css('color','red');
                            }else if(obj.result!='AC'){
                              $('#finalstatus').text('Status:'+obj.result);
                              $('#finalstatus').css('color','red');
                            }
                            
                            itemsProcessed++;
                            console.log(itemsProcessed);
                            
                          }
                        }
                    });
       
                  }
);

    });
    </script>